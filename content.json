{"pages":[],"posts":[{"title":"Install Stratum on Wedge100BF","text":"Stratum: The open source project owned by Open Networking Foundation(ONF) The device we used is Edgecore Wedge100BF-32X, but all the step are also can be used in Edgecore Wedge100BF-65X Device Edgecore Wedge100BF-32 Notice: Need to check the switch firmware version, otherwise it might be stuck when loading ONL If you need upgrade firmware, please contact switch vendor or following contact window Edgecore Networks: jimmy_ou@edge-core.com OpenBMC: 1.0.0.14 CPLD: 10.1 BIOS: R1.00.E2 (8/29/2018) EC: R04.E01(10/10/2018) StepsInstall ONL which contained ONLPv21onie-nos-install https://github.com/opennetworkinglab/OpenNetworkLinux/releases/download/onlpv2-dev-1.0.1/ONL-OS_2019-09-17.0112-b2c831f_AMD64_INSTALLED_INSTALLER Install Docker1curl -sSL https://get.docker.io | bash Pull Stratum container image1docker pull stratumproject/stratum-bf:9.0.0-4.14.49-OpenNetworkLinux Create Stratum scriptCreate a shell script called “start-stratum-container.sh” and chmod +x start-stratum-container.sh The script contain following code 12345678910111213141516171819202122set -eset -xONLP_MOUNT=$(ls /lib/**/libonlp* | awk '{print \"-v \" $1 \":\" $1 \" \" }')CONFIG_DIR=${CONFIG_DIR:-/root}LOG_DIR=${LOG_DIR:-/var/log}SDE_VERSION=${SDE_VERSION:-9.0.0}KERNEL_VERSION=$(uname -r)DOCKER_IMAGE=${DOCKER_IMAGE:-stratumproject/stratum-bf}DOCKER_IMAGE_TAG=${DOCKER_IMAGE_TAG:-$SDE_VERSION-$KERNEL_VERSION}docker run -it --privileged \\ -v /dev:/dev -v /sys:/sys \\ -v /lib/modules/$(uname -r):/lib/modules/$(uname -r) \\ $ONLP_MOUNT \\ -v /lib/platform-config:/lib/platform-config \\ -v /etc/onl:/etc/onl \\ -p 28000:28000 \\ -v $CONFIG_DIR:/stratum_configs \\ -v $LOG_DIR:/stratum_logs \\ $DOCKER_IMAGE:$DOCKER_IMAGE_TAG Run StratumFinally, just execute ./start-stratum-container.sh and all is done The p4runtime server is listening in port 28000 Options default config director is under /root, it will be mount to container with path /stratum_configs If you want to change the flags used in start Stratum, you could add stratum.flags file under /root","link":"/2020/01/26/Install-Stratum-on-Wedge100BF/"}],"tags":[{"name":"Stratum","slug":"Stratum","link":"/tags/Stratum/"},{"name":"Barefoot","slug":"Barefoot","link":"/tags/Barefoot/"},{"name":"Wedge100BF","slug":"Wedge100BF","link":"/tags/Wedge100BF/"}],"categories":[{"name":"Stratum","slug":"Stratum","link":"/categories/Stratum/"}]}